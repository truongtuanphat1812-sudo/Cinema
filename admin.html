<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Qu·∫£n l√Ω NeonFlix</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #111;
            color: #fff;
        }
        h1, h2 { text-align: center; }
        .nav { display:flex; justify-content: space-between; margin-bottom: 20px; }
        .nav button { margin-left: 10px; padding: 5px 10px; cursor: pointer; }
        .form-control { margin-bottom: 10px; }
        input[type="text"], input[type="url"] { padding: 5px; width: 100%; }
        button { cursor: pointer; background: #ff0066; border: none; color: #fff; padding: 5px 10px; margin-top: 5px; }
        .movie-item { background: #222; padding: 10px; margin-bottom: 10px; display:flex; justify-content: space-between; align-items: center; border-radius: 5px; }
        .movie-item img { width: 50px; height: auto; margin-right: 10px; }
        .movie-actions button { margin-left: 5px; }
    </style>
</head>
<body>

    <header class="nav">
        <h2>‚öôÔ∏è Qu·∫£n l√Ω NeonFlix</h2>
        <div class="nav-menu">
            <button onclick="window.location.href='index.html'">üè† Trang ch·ªß</button>
            <button onclick="logout()">üö™ ƒêƒÉng xu·∫•t</button>
        </div>
    </header>

    <h1>Qu·∫£n l√Ω phim</h1>

    <!-- Form th√™m/s·ª≠a phim -->
    <div class="form">
        <div class="form-control">
            <input type="text" id="movieName" placeholder="T√™n phim">
        </div>
        <div class="form-control">
            <input type="url" id="movieImage" placeholder="Link ·∫£nh phim">
        </div>
        <div class="form-control">
            <input type="text" id="movieDesc" placeholder="M√¥ t·∫£ ng·∫Øn">
        </div>
        <button onclick="addOrUpdateMovie()">Th√™m / C·∫≠p nh·∫≠t phim</button>
    </div>

    <h2>Danh s√°ch phim</h2>
    <div id="movieList"></div>

    <script>
        // ==== B·∫£o v·ªá trang: ch·ªâ admin m·ªõi v√†o ====
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if(!currentUser || currentUser.role !== 'admin') {
            alert('B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang n√†y!');
            window.location.href = 'dangnhap.html';
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'dangnhap.html';
        }

        // ==== Qu·∫£n l√Ω phim ====
        let movies = JSON.parse(localStorage.getItem('movies')) || [];
        let editIndex = -1;

        function renderMovies() {
            const movieList = document.getElementById('movieList');
            movieList.innerHTML = '';
            movies.forEach((movie, index) => {
                const div = document.createElement('div');
                div.className = 'movie-item';
                div.innerHTML = `
                    <div style="display:flex; align-items:center;">
                        <img src="${movie.image}" alt="${movie.name}">
                        <div>
                            <strong>${movie.name}</strong><br>
                            <small>${movie.desc}</small>
                        </div>
                    </div>
                    <div class="movie-actions">
                        <button onclick="editMovie(${index})">‚úèÔ∏è S·ª≠a</button>
                        <button onclick="deleteMovie(${index})">üóë X√≥a</button>
                    </div>
                `;
                movieList.appendChild(div);
            });
        }

        function addOrUpdateMovie() {
            const name = document.getElementById('movieName').value;
            const image = document.getElementById('movieImage').value;
            const desc = document.getElementById('movieDesc').value;

            if(!name || !image) {
                alert('T√™n v√† ·∫£nh phim l√† b·∫Øt bu·ªôc!');
                return;
            }

            if(editIndex === -1) {
                movies.push({name, image, desc});
            } else {
                movies[editIndex] = {name, image, desc};
                editIndex = -1;
            }

            localStorage.setItem('movies', JSON.stringify(movies));
            document.getElementById('movieName').value = '';
            document.getElementById('movieImage').value = '';
            document.getElementById('movieDesc').value = '';
            renderMovies();
        }

        function editMovie(index) {
            const movie = movies[index];
            document.getElementById('movieName').value = movie.name;
            document.getElementById('movieImage').value = movie.image;
            document.getElementById('movieDesc').value = movie.desc;
            editIndex = index;
        }

        function deleteMovie(index) {
            if(confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a phim n√†y?')) {
                movies.splice(index, 1);
                localStorage.setItem('movies', JSON.stringify(movies));
                renderMovies();
            }
        }

        renderMovies();
    </script>

</body>
</html>
